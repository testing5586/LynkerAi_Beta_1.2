<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="guruRegister.pageTitle">å‘½ç†å¸ˆæ³¨å†Œ - çµå®¢AI</title>
    <link rel="stylesheet" href="/static/css/user-profile-card.css">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", sans-serif;
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        .guru-register-container {
            display: flex;
            min-height: 100vh;
        }
        
        /* å·¦ä¾§ç´«è‰²æ˜Ÿç©ºèƒŒæ™¯åŒº */
        .left-panel {
            flex: 0 0 40%;
            background: linear-gradient(135deg, #5b4fa3 0%, #7c3f9e 50%, #4a3f87 100%);
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            padding: 40px;
        }
        
        /* æ˜Ÿç©ºæ•ˆæœ */
        .left-panel::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(2px 2px at 20% 30%, white, transparent),
                radial-gradient(2px 2px at 60% 70%, white, transparent),
                radial-gradient(1px 1px at 50% 50%, white, transparent),
                radial-gradient(1px 1px at 80% 10%, white, transparent),
                radial-gradient(2px 2px at 90% 60%, white, transparent),
                radial-gradient(1px 1px at 33% 80%, white, transparent),
                radial-gradient(1px 1px at 15% 90%, white, transparent);
            background-size: 200% 200%;
            animation: stars 20s linear infinite;
            opacity: 0.5;
        }
        
        @keyframes stars {
            from { transform: translateY(0); }
            to { transform: translateY(-100%); }
        }
        
        /* LogoåŒºåŸŸ */
        .logo-area {
            position: relative;
            z-index: 10;
        }
        
        .logo-link {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
            transition: transform 0.3s;
        }
        
        .logo-link:hover {
            transform: scale(1.05);
        }
        
        .logo-icon {
            width: 32px;
            height: 32px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }
        
        .logo-text {
            font-size: 20px;
            font-weight: 600;
            color: white;
        }
        
        /* ç´«å¾®æ–—æ•°ç›˜è£…é¥° */
        .ziwei-chart-decoration {
            position: relative;
            z-index: 5;
            display: flex;
            justify-content: center;
            align-items: center;
            flex: 1;
        }
        
        /* æ‹›å‹Ÿæ–‡æ¡ˆåŒº */
        .recruitment-text {
            position: relative;
            z-index: 10;
            text-align: center;
            color: white;
        }
        
        .recruitment-text h2 {
            font-size: 28px;
            font-weight: 600;
            margin-bottom: 12px;
            line-height: 1.4;
        }
        
        .recruitment-text p {
            font-size: 14px;
            opacity: 0.9;
            line-height: 1.6;
        }
        
        /* å³ä¾§ç™½è‰²è¡¨å•åŒº */
        .right-panel {
            flex: 0 0 60%;
            background: white;
            padding: 60px 80px;
            overflow-y: auto;
            position: relative;
        }
        
        /* è¯­è¨€åˆ‡æ¢å™¨ */
        .lang-switcher-wrapper {
            position: absolute;
            top: 30px;
            right: 40px;
            z-index: 100;
        }
        
        /* è¦†ç›–è¯­è¨€åˆ‡æ¢å™¨æŒ‰é’®æ ·å¼ï¼Œä½¿å…¶åœ¨ç™½è‰²èƒŒæ™¯ä¸Šå¯è§ */
        .lang-switcher-wrapper .lang-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
            border: none !important;
            color: white !important;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
        }
        
        .lang-switcher-wrapper .lang-btn:hover {
            transform: translateY(-2px) !important;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4) !important;
        }
        
        /* è¡¨å•å¤´éƒ¨ */
        .form-header {
            margin-bottom: 40px;
        }
        
        .form-header h1 {
            font-size: 32px;
            color: #1a1a1a;
            margin-bottom: 12px;
            font-weight: 600;
        }
        
        .form-header p {
            font-size: 14px;
            color: #666;
        }
        
        .form-header p .required-star {
            color: #f44336;
        }
        
        /* è¡¨å•ç»„ */
        .form-group {
            margin-bottom: 24px;
        }
        
        .form-group label {
            display: block;
            font-size: 14px;
            color: #333;
            margin-bottom: 8px;
            font-weight: 500;
        }
        
        .form-group label .required {
            color: #f44336;
            margin-left: 2px;
        }
        
        .input-wrapper {
            position: relative;
        }
        
        .input-icon {
            position: absolute;
            right: 16px;
            top: 50%;
            transform: translateY(-50%);
            color: #999;
            font-size: 18px;
            pointer-events: none;
        }
        
        input[type="text"],
        input[type="email"],
        input[type="tel"],
        input[type="password"],
        select {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s;
            background: #fafafa;
        }
        
        /* æœ‰å›¾æ ‡çš„inputéœ€è¦æ›´å¤§çš„å³ä¾§padding */
        .input-wrapper input {
            padding-right: 45px;
        }
        
        input:focus,
        select:focus {
            outline: none;
            border-color: #667eea;
            background: white;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        input::placeholder {
            color: #bbb;
            font-size: 13px;
        }
        
        /* é‚®ç®±éªŒè¯ç å¸ƒå±€ */
        .email-verify-group {
            display: flex;
            gap: 12px;
        }
        
        .email-verify-group input {
            flex: 1;
        }
        
        .verify-code-btn {
            flex: 0 0 auto;
            padding: 12px 24px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
            white-space: nowrap;
            transition: all 0.3s;
        }
        
        .verify-code-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }
        
        .verify-code-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        /* æ‰‹æœºå·ç å¸ƒå±€ */
        .phone-group {
            display: flex;
            gap: 12px;
        }
        
        .phone-group select {
            flex: 0 0 100px;
        }
        
        .phone-group input {
            flex: 1;
        }
        
        /* å¤´åƒä¸Šä¼  */
        .avatar-upload-area {
            display: flex;
            align-items: center;
            gap: 20px;
        }
        
        .avatar-preview {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: #f0f0f0;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            position: relative;
        }
        
        .avatar-preview .camera-icon {
            font-size: 32px;
            color: #999;
        }
        
        .avatar-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .upload-avatar-btn {
            padding: 10px 20px;
            border: 2px solid #d946ef;
            background: white;
            color: #d946ef;
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .upload-avatar-btn:hover {
            background: #d946ef;
            color: white;
        }
        
        #avatarFileInput {
            display: none;
        }
        
        /* ä¸“ä¸šé¢†åŸŸå¤é€‰æ¡† */
        .specializations-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
        }
        
        .spec-checkbox {
            display: flex;
            align-items: center;
            padding: 12px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            background: #fafafa;
        }
        
        .spec-checkbox:hover {
            border-color: #667eea;
            background: #f8f9ff;
        }
        
        .spec-checkbox input[type="checkbox"] {
            margin-right: 10px;
            width: 18px;
            height: 18px;
            cursor: pointer;
        }
        
        .spec-checkbox.checked {
            border-color: #667eea;
            background: #f0f3ff;
        }
        
        /* æäº¤æŒ‰é’® */
        .submit-btn {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 32px;
        }
        
        .submit-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(79, 70, 229, 0.3);
        }
        
        .submit-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        /* åº•éƒ¨åè®®æ–‡å­— */
        .terms-text {
            text-align: center;
            font-size: 12px;
            color: #999;
            margin-top: 16px;
            line-height: 1.6;
        }
        
        .terms-text a {
            color: #667eea;
            text-decoration: none;
        }
        
        .terms-text a:hover {
            text-decoration: underline;
        }
        
        /* æ¶ˆæ¯æç¤º */
        .message {
            padding: 12px 16px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-size: 14px;
        }
        
        .message.error {
            background: #fee;
            border-left: 4px solid #f44336;
            color: #c62828;
        }
        
        .message.success {
            background: #e8f5e9;
            border-left: 4px solid #4caf50;
            color: #2e7d32;
        }
        
        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 1024px) {
            .left-panel {
                flex: 0 0 35%;
            }
            .right-panel {
                flex: 0 0 65%;
                padding: 40px;
            }
        }
        
        @media (max-width: 768px) {
            .guru-register-container {
                flex-direction: column;
            }
            .left-panel {
                flex: 0 0 auto;
                min-height: 300px;
                padding: 30px 20px;
            }
            .right-panel {
                flex: 1;
                padding: 30px 20px;
            }
            .form-header h1 {
                font-size: 24px;
            }
            .specializations-grid {
                grid-template-columns: 1fr;
            }
            .lang-switcher-wrapper {
                right: 20px;
                top: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="guru-register-container">
        <!-- å·¦ä¾§ç´«è‰²æ˜Ÿç©ºèƒŒæ™¯åŒº -->
        <div class="left-panel">
            <!-- LogoåŒºåŸŸ -->
            <div class="logo-area">
                <a href="/" class="logo-link">
                    <div class="logo-icon">â­•</div>
                    <span class="logo-text" data-i18n="common.lynkerAI">çµå®¢AI</span>
                </a>
            </div>
            
            <!-- ç´«å¾®æ–—æ•°ç›˜è£…é¥° -->
            <div class="ziwei-chart-decoration">
                <svg width="300" height="300" viewBox="0 0 300 300" xmlns="http://www.w3.org/2000/svg">
                    <!-- å¤–åœ† -->
                    <circle cx="150" cy="150" r="140" fill="none" stroke="rgba(255,255,255,0.3)" stroke-width="2"/>
                    <circle cx="150" cy="150" r="120" fill="none" stroke="rgba(255,255,255,0.3)" stroke-width="1.5"/>
                    <circle cx="150" cy="150" r="100" fill="none" stroke="rgba(255,255,255,0.3)" stroke-width="1.5"/>
                    <circle cx="150" cy="150" r="80" fill="none" stroke="rgba(255,255,255,0.3)" stroke-width="1.5"/>
                    <circle cx="150" cy="150" r="60" fill="none" stroke="rgba(255,255,255,0.3)" stroke-width="1.5"/>
                    <circle cx="150" cy="150" r="40" fill="none" stroke="rgba(255,255,255,0.3)" stroke-width="1"/>
                    <circle cx="150" cy="150" r="20" fill="none" stroke="rgba(255,255,255,0.3)" stroke-width="1"/>
                    
                    <!-- 12ä¸ªæ–¹ä½çš„æ˜Ÿç‚¹ -->
                    <circle cx="150" cy="10" r="6" fill="white" opacity="0.8"/>
                    <circle cx="225" cy="37.5" r="6" fill="white" opacity="0.8"/>
                    <circle cx="262.5" cy="112.5" r="6" fill="white" opacity="0.8"/>
                    <circle cx="290" cy="150" r="6" fill="white" opacity="0.8"/>
                    <circle cx="262.5" cy="187.5" r="6" fill="white" opacity="0.8"/>
                    <circle cx="225" cy="262.5" r="6" fill="white" opacity="0.8"/>
                    <circle cx="150" cy="290" r="6" fill="white" opacity="0.8"/>
                    <circle cx="75" cy="262.5" r="6" fill="white" opacity="0.8"/>
                    <circle cx="37.5" cy="187.5" r="6" fill="white" opacity="0.8"/>
                    <circle cx="10" cy="150" r="6" fill="white" opacity="0.8"/>
                    <circle cx="37.5" cy="112.5" r="6" fill="white" opacity="0.8"/>
                    <circle cx="75" cy="37.5" r="6" fill="white" opacity="0.8"/>
                    
                    <!-- ä¸­å¿ƒæ˜Ÿ -->
                    <circle cx="150" cy="150" r="8" fill="white" opacity="0.9"/>
                </svg>
            </div>
            
            <!-- æ‹›å‹Ÿæ–‡æ¡ˆ -->
            <div class="recruitment-text">
                <h2 data-i18n="guruRegister.recruitmentTitle">åŠ å…¥æˆ‘ä»¬çš„å‘½ç†å¸ˆå›¢é˜Ÿï¼Œåˆ†äº«æ‚¨çš„æ™ºæ…§</h2>
                <p data-i18n="guruRegister.recruitmentSubtitle">æˆä¸ºå¹³å°è®¤è¯å‘½ç†å¸ˆï¼Œå¼€å¯æ‚¨çš„ä¸“ä¸šæ•°å­—ä¹‹æ—…</p>
            </div>
        </div>
        
        <!-- å³ä¾§ç™½è‰²è¡¨å•åŒº -->
        <div class="right-panel">
            <!-- è¯­è¨€åˆ‡æ¢å™¨ -->
            <div class="lang-switcher-wrapper" id="lang-switcher-nav"></div>
            
            <!-- è¡¨å•å¤´éƒ¨ -->
            <div class="form-header">
                <h1 data-i18n="guruRegister.formTitle">å‘½ç†å¸ˆæ³¨å†Œ</h1>
                <p data-i18n-html="guruRegister.formSubtitle">è¯·å¡«å†™ä»¥ä¸‹ä¿¡æ¯å®Œæˆæ³¨å†Œï¼Œ<span class="required-star">*</span>ä¸ºå¿…å¡«é¡¹</p>
            </div>
            
            <!-- æ¶ˆæ¯æç¤ºåŒº -->
            <div id="messageArea"></div>
            
            <!-- æ³¨å†Œè¡¨å• -->
            <form id="guruRegisterForm">
                <!-- å§“å -->
                <div class="form-group">
                    <label for="realName">
                        <span data-i18n="guruRegister.realNameLabel">å§“å</span>
                        <span class="required">*</span>
                    </label>
                    <div class="input-wrapper">
                        <input 
                            type="text" 
                            id="realName" 
                            name="realName"
                            data-i18n-placeholder="guruRegister.realNamePlaceholder"
                            placeholder="è¯·è¾“å…¥æ‚¨çš„çœŸå®å§“å"
                            required
                        >
                        <span class="input-icon">ğŸ‘¤</span>
                    </div>
                </div>
                
                <!-- ç”µå­é‚®ç®± -->
                <div class="form-group">
                    <label for="email">
                        <span data-i18n="guruRegister.emailLabel">ç”µå­é‚®ç®±</span>
                        <span class="required">*</span>
                    </label>
                    <div class="email-verify-group">
                        <div class="input-wrapper" style="flex: 1;">
                            <input 
                                type="email" 
                                id="email" 
                                name="email"
                                data-i18n-placeholder="guruRegister.emailPlaceholder"
                                placeholder="è¯·è¾“å…¥æ‚¨çš„ç”µå­é‚®ç®±"
                                required
                            >
                            <span class="input-icon">âœ‰ï¸</span>
                        </div>
                        <button 
                            type="button" 
                            class="verify-code-btn" 
                            id="sendVerifyCodeBtn"
                            data-i18n="guruRegister.sendVerifyCode"
                        >
                            å‘é€éªŒè¯ç 
                        </button>
                    </div>
                </div>
                
                <!-- å¯†ç ï¼ˆä»…ç›´æ¥æ³¨å†Œæ¨¡å¼ï¼‰ -->
                {% if is_direct_register %}
                <div class="form-group">
                    <label for="password">
                        <span data-i18n="guruRegister.passwordLabel">è®¾ç½®å¯†ç </span>
                        <span class="required">*</span>
                    </label>
                    <div class="input-wrapper">
                        <input 
                            type="password" 
                            id="password" 
                            name="password"
                            data-i18n-placeholder="guruRegister.passwordPlaceholder"
                            placeholder="è¯·è®¾ç½®æ‚¨çš„ç™»å½•å¯†ç ï¼ˆè‡³å°‘6ä½ï¼‰"
                            minlength="6"
                            required
                        >
                        <span class="input-icon">ğŸ”’</span>
                    </div>
                </div>
                {% endif %}
                
                <!-- æ‰‹æœºå·ç  -->
                <div class="form-group">
                    <label for="phone">
                        <span data-i18n="guruRegister.phoneLabel">æ‰‹æœºå·ç </span>
                        <span class="required">*</span>
                    </label>
                    <div class="phone-group">
                        <select id="countryCode" name="countryCode">
                            <option value="+86">+86</option>
                            <option value="+1">+1</option>
                            <option value="+44">+44</option>
                            <option value="+81">+81</option>
                            <option value="+82">+82</option>
                            <option value="+65">+65</option>
                            <option value="+60">+60</option>
                            <option value="+66">+66</option>
                            <option value="+84">+84</option>
                        </select>
                        <div class="input-wrapper" style="flex: 1;">
                            <input 
                                type="tel" 
                                id="phone" 
                                name="phone"
                                data-i18n-placeholder="guruRegister.phonePlaceholder"
                                placeholder="è¯·è¾“å…¥æ‚¨çš„æ‰‹æœºå·ç "
                                required
                            >
                            <span class="input-icon">ğŸ“±</span>
                        </div>
                    </div>
                </div>
                
                <!-- ä¸ªäººå¤´åƒ -->
                <div class="form-group">
                    <label data-i18n="guruRegister.avatarLabel">ä¸ªäººå¤´åƒ</label>
                    <div class="avatar-upload-area">
                        <div class="avatar-preview" id="avatarPreview">
                            <span class="camera-icon">ğŸ“·</span>
                        </div>
                        <button 
                            type="button" 
                            class="upload-avatar-btn" 
                            id="uploadAvatarBtn"
                            data-i18n="guruRegister.uploadAvatar"
                        >
                            ä¸Šä¼ å›¾ç‰‡
                        </button>
                        <input type="file" id="avatarFileInput" accept="image/*">
                    </div>
                </div>
                
                <!-- ä¸“ä¸šé¢†åŸŸ -->
                <div class="form-group">
                    <label>
                        <span data-i18n="guruRegister.specializationsLabel">ä¸“ä¸šé¢†åŸŸ</span>
                        <span class="required">*</span>
                        <span style="font-weight: normal; color: #999; font-size: 12px;" data-i18n="guruRegister.specializationsHint">ï¼ˆå¯å¤šé€‰ï¼‰</span>
                    </label>
                    <div class="specializations-grid">
                        <label class="spec-checkbox">
                            <input type="checkbox" name="specialization" value="bazi">
                            <span data-i18n="guruRegister.specBazi">å…«å­—</span>
                        </label>
                        <label class="spec-checkbox">
                            <input type="checkbox" name="specialization" value="liuyao">
                            <span data-i18n="guruRegister.specLiuyao">å…­çˆ»</span>
                        </label>
                        <label class="spec-checkbox">
                            <input type="checkbox" name="specialization" value="meihua">
                            <span data-i18n="guruRegister.specMeihua">æ¢…èŠ±æ˜“æ•°</span>
                        </label>
                        <label class="spec-checkbox">
                            <input type="checkbox" name="specialization" value="astrology">
                            <span data-i18n="guruRegister.specAstrology">å æ˜Ÿ</span>
                        </label>
                        <label class="spec-checkbox">
                            <input type="checkbox" name="specialization" value="ziwei">
                            <span data-i18n="guruRegister.specZiwei">ç´«å¾®æ–—æ•°</span>
                        </label>
                        <label class="spec-checkbox">
                            <input type="checkbox" name="specialization" value="qimen">
                            <span data-i18n="guruRegister.specQimen">å¥‡é—¨</span>
                        </label>
                        <label class="spec-checkbox">
                            <input type="checkbox" name="specialization" value="tarot">
                            <span data-i18n="guruRegister.specTarot">å¡”ç½—</span>
                        </label>
                        <label class="spec-checkbox">
                            <input type="checkbox" name="specialization" value="æ‹©å‰">
                            <span data-i18n="guruRegister.specZeji">æ‹©å‰</span>
                        </label>
                    </div>
                </div>
                
                <!-- æäº¤æŒ‰é’® -->
                <button 
                    type="submit" 
                    class="submit-btn" 
                    id="submitBtn"
                    data-i18n="guruRegister.submitBtn"
                >
                    æäº¤æ³¨å†Œç”³è¯·
                </button>
                
                <!-- åº•éƒ¨åè®® -->
                <div class="terms-text">
                    <span data-i18n-html="guruRegister.termsText">
                        ç‚¹å‡»æäº¤å³åŒæ„æœåŠ¡æ¡æ¬¾ å’Œã€Šæˆ‘ä»¬æ”¿ç­–ã€‹å’Œã€Šéšç§æ”¿ç­–ã€‹
                    </span>
                </div>
            </form>
        </div>
    </div>
    
    <script src="/static/js/i18n.js"></script>
    <script src="/static/js/lang-switcher.js"></script>
    <script>
        // åˆå§‹åŒ–è¯­è¨€åˆ‡æ¢å™¨ - å»¶è¿Ÿæ‰§è¡Œç¡®ä¿æ‰€æœ‰è„šæœ¬éƒ½å·²åŠ è½½
        window.addEventListener('load', () => {
            setTimeout(() => {
                // ç¡®ä¿å‡½æ•°å·²åŠ è½½
                if (typeof injectLanguageSwitcherStyles === 'function') {
                    injectLanguageSwitcherStyles();
                }
                
                const langSwitcherContainer = document.getElementById('lang-switcher-nav');
                if (langSwitcherContainer && typeof createLanguageSwitcher === 'function') {
                    langSwitcherContainer.innerHTML = createLanguageSwitcher();
                    
                    // æ‰‹åŠ¨ç»‘å®šäº‹ä»¶
                    const langBtn = document.getElementById('langBtn');
                    const langDropdown = document.getElementById('langDropdown');
                    
                    if (langBtn && langDropdown) {
                        langBtn.addEventListener('click', (e) => {
                            e.stopPropagation();
                            langDropdown.classList.toggle('show');
                        });
                        
                        document.addEventListener('click', () => {
                            langDropdown.classList.remove('show');
                        });
                        
                        document.querySelectorAll('.lang-option').forEach(option => {
                            option.addEventListener('click', async () => {
                                const lang = option.getAttribute('data-lang');
                                if (typeof i18n !== 'undefined' && typeof i18n.switchLanguage === 'function') {
                                    await i18n.switchLanguage(lang);
                                    location.reload(); // åˆ·æ–°é¡µé¢åº”ç”¨æ–°è¯­è¨€
                                }
                            });
                        });
                    } else {
                        console.error('è¯­è¨€åˆ‡æ¢å™¨æŒ‰é’®æœªæ‰¾åˆ°');
                    }
                } else {
                    console.error('createLanguageSwitcher å‡½æ•°æœªåŠ è½½æˆ–å®¹å™¨æœªæ‰¾åˆ°');
                }
            }, 300); // å»¶è¿Ÿ300msç¡®ä¿è„šæœ¬åŠ è½½å®Œæˆ
        });
        
        // å¤é€‰æ¡†æ ·å¼åˆ‡æ¢
        document.querySelectorAll('.spec-checkbox input[type="checkbox"]').forEach(checkbox => {
            checkbox.addEventListener('change', (e) => {
                e.target.closest('.spec-checkbox').classList.toggle('checked', e.target.checked);
            });
        });
        
        // å¤´åƒä¸Šä¼ é¢„è§ˆ
        const uploadAvatarBtn = document.getElementById('uploadAvatarBtn');
        const avatarFileInput = document.getElementById('avatarFileInput');
        const avatarPreview = document.getElementById('avatarPreview');
        let uploadedAvatarFile = null;
        
        uploadAvatarBtn.addEventListener('click', () => {
            avatarFileInput.click();
        });
        
        avatarFileInput.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) {
                uploadedAvatarFile = file;
                const reader = new FileReader();
                reader.onload = (e) => {
                    avatarPreview.innerHTML = `<img src="${e.target.result}" alt="Avatar">`;
                };
                reader.readAsDataURL(file);
            }
        });
        
        // éªŒè¯ç å€’è®¡æ—¶
        const sendVerifyCodeBtn = document.getElementById('sendVerifyCodeBtn');
        let countdown = 0;
        
        sendVerifyCodeBtn.addEventListener('click', async () => {
            const email = document.getElementById('email').value.trim();
            
            if (!email) {
                showMessage('è¯·å…ˆè¾“å…¥é‚®ç®±åœ°å€', 'error');
                return;
            }
            
            if (!email.match(/^[^\s@]+@[^\s@]+\.[^\s@]+$/)) {
                showMessage('è¯·è¾“å…¥æœ‰æ•ˆçš„é‚®ç®±åœ°å€', 'error');
                return;
            }
            
            // TODO: å®é™…å‘é€éªŒè¯ç çš„APIè°ƒç”¨
            showMessage('éªŒè¯ç å·²å‘é€ï¼ˆåŠŸèƒ½å¼€å‘ä¸­ï¼‰', 'success');
            
            // å¼€å§‹å€’è®¡æ—¶
            countdown = 60;
            sendVerifyCodeBtn.disabled = true;
            const interval = setInterval(() => {
                countdown--;
                sendVerifyCodeBtn.textContent = `${countdown}ç§’åé‡å‘`;
                if (countdown <= 0) {
                    clearInterval(interval);
                    sendVerifyCodeBtn.disabled = false;
                    sendVerifyCodeBtn.setAttribute('data-i18n', 'guruRegister.sendVerifyCode');
                    sendVerifyCodeBtn.textContent = i18n.t('guruRegister.sendVerifyCode');
                }
            }, 1000);
        });
        
        // è¡¨å•æäº¤
        const form = document.getElementById('guruRegisterForm');
        const submitBtn = document.getElementById('submitBtn');
        
        // æ£€æµ‹æ˜¯å¦ä¸ºç›´æ¥æ³¨å†Œæ¨¡å¼
        const isDirectRegister = {{ 'true' if is_direct_register else 'false' }};
        
        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const realName = document.getElementById('realName').value.trim();
            const email = document.getElementById('email').value.trim();
            const countryCode = document.getElementById('countryCode').value;
            const phone = document.getElementById('phone').value.trim();
            const password = isDirectRegister ? document.getElementById('password')?.value : null;
            
            // æ”¶é›†é€‰ä¸­çš„ä¸“ä¸šé¢†åŸŸ
            const specializations = Array.from(
                document.querySelectorAll('input[name="specialization"]:checked')
            ).map(cb => cb.value);
            
            // éªŒè¯
            if (!realName || !email || !phone) {
                showMessage('è¯·å¡«å†™æ‰€æœ‰å¿…å¡«å­—æ®µ', 'error');
                return;
            }
            
            // ç›´æ¥æ³¨å†Œæ¨¡å¼éœ€è¦éªŒè¯å¯†ç 
            if (isDirectRegister && (!password || password.length < 6)) {
                showMessage('å¯†ç è‡³å°‘éœ€è¦6ä¸ªå­—ç¬¦', 'error');
                return;
            }
            
            if (specializations.length === 0) {
                showMessage('è¯·è‡³å°‘é€‰æ‹©ä¸€é¡¹ä¸“ä¸šé¢†åŸŸ', 'error');
                return;
            }
            
            submitBtn.disabled = true;
            submitBtn.textContent = 'æäº¤ä¸­...';
            
            try {
                let apiUrl, formData;
                
                if (isDirectRegister) {
                    // ç›´æ¥æ³¨å†Œæ¨¡å¼ï¼šåˆ›å»ºè´¦å· + æ¡£æ¡ˆ
                    apiUrl = '/api/guru-register-direct';
                    formData = {
                        email: email,
                        password: password,
                        displayName: realName,
                        realName: realName,
                        phoneNumber: `${countryCode}${phone}`,
                        bio: `ä¸“ä¸šå‘½ç†å¸ˆï¼Œæ“…é•¿${specializations.join('ã€')}`,
                        specializations: specializations,
                        region: null,
                        nationality: null,
                        aiProvider: 'OpenAI',
                        aiTone: 'professional'
                    };
                } else {
                    // å·²ç™»å½•æ¨¡å¼ï¼šä»…åˆ›å»ºæ¡£æ¡ˆ
                    apiUrl = '/api/guru/profile';
                    formData = {
                        displayName: realName,
                        realName: realName,
                        phoneNumber: `${countryCode}${phone}`,
                        bio: `ä¸“ä¸šå‘½ç†å¸ˆï¼Œæ“…é•¿${specializations.join('ã€')}`,
                        specializations: specializations,
                        region: null,
                        nationality: null,
                        aiProvider: 'OpenAI',
                        aiTone: 'professional'
                    };
                }
                
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(formData)
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    showMessage('æ³¨å†ŒæˆåŠŸï¼æ­£åœ¨è·³è½¬...', 'success');
                    setTimeout(() => {
                        window.location.href = data.redirectTo || '/guru/dashboard';
                    }, 1500);
                } else {
                    showMessage(data.error || 'æ³¨å†Œå¤±è´¥ï¼Œè¯·é‡è¯•', 'error');
                    submitBtn.disabled = false;
                    submitBtn.setAttribute('data-i18n', 'guruRegister.submitBtn');
                    submitBtn.textContent = i18n.t('guruRegister.submitBtn');
                }
            } catch (error) {
                console.error('Submit error:', error);
                showMessage('ç½‘ç»œé”™è¯¯ï¼Œè¯·ç¨åé‡è¯•', 'error');
                submitBtn.disabled = false;
                submitBtn.setAttribute('data-i18n', 'guruRegister.submitBtn');
                submitBtn.textContent = i18n.t('guruRegister.submitBtn');
            }
        });
        
        // æ˜¾ç¤ºæ¶ˆæ¯
        function showMessage(text, type) {
            const messageArea = document.getElementById('messageArea');
            messageArea.innerHTML = `<div class="message ${type}">${text}</div>`;
            setTimeout(() => {
                messageArea.innerHTML = '';
            }, 5000);
        }
    </script>
</body>
</html>
