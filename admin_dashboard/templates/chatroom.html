<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸‰æ–¹AIæ™ºèƒ½åä½œå¼•æ“ v2.0 - LynkerAI</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.6.0/socket.io.js"></script>
    <style>
        .agent-badge {
            display: inline-block;
            padding: 4px 10px;
            margin: 0 5px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: bold;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        .agent-info {
            background: rgba(255,255,255,0.05);
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border-left: 3px solid #667eea;
        }
        .ai-msg.child {
            background: linear-gradient(135deg, rgba(52, 211, 153, 0.1) 0%, rgba(16, 185, 129, 0.05) 100%);
            border-left: 3px solid #34d399;
            animation: fadeIn 0.5s;
        }
        .ai-msg.leader {
            background: linear-gradient(135deg, rgba(251, 191, 36, 0.1) 0%, rgba(245, 158, 11, 0.05) 100%);
            border-left: 3px solid #fbbf24;
            animation: fadeIn 0.6s;
        }
        .ai-msg.master {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.1) 0%, rgba(109, 40, 217, 0.05) 100%);
            border-left: 3px solid #8b5cf6;
            animation: fadeIn 0.7s;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .system-info {
            background: rgba(102, 126, 234, 0.1);
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 10px;
            border: 1px solid rgba(102, 126, 234, 0.3);
        }
        .system-info h3 {
            margin-top: 0;
            color: #667eea;
        }
    </style>
</head>
<body>
<div class="sidebar">
    <h2>ğŸ§  ä¸‰æ–¹AIåä½œ v2.0</h2>
    <p class="sidebar-subtitle">æ™ºèƒ½æ¨ç†å¼•æ“</p>
    <ul>
        <li><a href="/dashboard">ğŸ“Š Dashboard</a></li>
        <li><a href="/chatroom" class="active">ğŸ’¬ AI åä½œèŠå¤©</a></li>
        <li><a href="/verify_view">ğŸ” çœŸå‘½ç›˜éªŒè¯</a></li>
        <li><a href="/superintendent/questionnaire/">ğŸ“‹ é—®å·ç®¡ç†</a></li>
    </ul>
    
    <div class="ai-status">
        <h4>AI åä½œå±‚çº§</h4>
        <div class="status-item">
            <span class="status-dot online"></span>
            <span>Master AI ğŸ§ </span>
        </div>
        <div class="status-item">
            <span class="status-dot online"></span>
            <span>Group Leader ğŸ§©</span>
        </div>
        <div class="status-item">
            <span class="status-dot online"></span>
            <span>Child AI ğŸ¤–</span>
        </div>
    </div>

    {% if agents %}
    <div class="agent-info">
        <h4>ğŸ”§ å¼•æ“é…ç½®</h4>
        <p style="font-size: 12px; margin: 5px 0;">
            Master: {{ agents.master.model }}<br>
            Leader: {{ agents.leader.model }}<br>
            Child: {{ agents.child.model }}
        </p>
    </div>
    {% endif %}
</div>

<div class="main">
    <h1>ğŸ§  Superintendent AI æŒ‡ä»¤å°</h1>
    <p class="timestamp">ä¸‰æ–¹AIæ™ºèƒ½åä½œå¼•æ“ v2.0 - å®æ—¶æ¨ç†ç³»ç»Ÿ</p>
    
    <div class="system-info">
        <h3>ğŸ’¡ ç³»ç»Ÿè¯´æ˜</h3>
        <p>æ­¤èŠå¤©å®¤å·²æ¥å…¥ <strong>Lynker Engine v2.0</strong>ï¼Œä¸‰æ–¹ AI å°†åä½œå¤„ç†æ‚¨çš„æŸ¥è¯¢ï¼š</p>
        <ul style="margin: 10px 0; padding-left: 20px;">
            <li><strong>ğŸ¤– Child AI</strong>: æ£€ç´¢æ•°æ®åº“ï¼Œè¯†åˆ«å‘½ç›˜æ¨¡å¼ä¸ç»Ÿè®¡è§„å¾‹</li>
            <li><strong>ğŸ§© Group Leader</strong>: åˆ†é…ä»»åŠ¡ï¼Œæ•´åˆ Child AI çš„åˆ†æç»“æœ</li>
            <li><strong>ğŸ§  Master AI</strong>: ç»¼åˆ Vault çŸ¥è¯†åº“ï¼Œæä¾›æœ€ç»ˆç»“è®ºä¸å»ºè®®</li>
        </ul>
    </div>
    
    <div class="chat-container">
        <div id="chat-window" class="chat-window">
            <div class="system-msg">âœ… ç³»ç»Ÿ: Lynker Engine v2.0 å·²å°±ç»ªï¼Œä¸‰æ–¹ AI å¾…å‘½ä¸­...</div>
        </div>
        
        <div class="chat-input-container">
            <input id="msg" type="text" placeholder="è¾“å…¥å‘½ä»¤æˆ–æé—®ï¼ˆä¾‹å¦‚ï¼šåˆ†æå‘½ç›˜æ•°æ®åº“çš„é«˜é¢‘ç»„åˆï¼‰..." />
            <button onclick="sendMsg()">å‘é€</button>
        </div>
    </div>
</div>

<script>
const socket = io();

function sendMsg() {
    const msgInput = document.getElementById('msg');
    const msg = msgInput.value.trim();
    
    if (!msg) return;
    
    const chatWindow = document.getElementById('chat-window');
    chatWindow.innerHTML += `<div class="msg user-msg">ğŸ‘¤ Superintendent: ${msg}</div>`;
    
    socket.emit('send_message', { message: msg });
    msgInput.value = '';
    
    chatWindow.scrollTop = chatWindow.scrollHeight;
}

document.getElementById('msg').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
        sendMsg();
    }
});

socket.on('receive_message', function(data){
    const chatWindow = document.getElementById('chat-window');
    
    if (Array.isArray(data)) {
        data.forEach((reply, index) => {
            let cssClass = 'ai-msg';
            
            if (reply.includes('ğŸ¤–') || reply.includes('Child AI')) {
                cssClass += ' child';
            } else if (reply.includes('ğŸ§©') || reply.includes('Group Leader')) {
                cssClass += ' leader';
            } else if (reply.includes('ğŸ§ ') || reply.includes('Master AI')) {
                cssClass += ' master';
            }
            
            setTimeout(() => {
                chatWindow.innerHTML += `<div class="msg ${cssClass}">${reply}</div>`;
                chatWindow.scrollTop = chatWindow.scrollHeight;
            }, index * 200);
        });
    } else {
        chatWindow.innerHTML += `<div class="msg ai-msg">${data}</div>`;
        chatWindow.scrollTop = chatWindow.scrollHeight;
    }
});
</script>
</body>
</html>
