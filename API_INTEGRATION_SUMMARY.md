# Master AI ç»Ÿä¸€ API æ•´åˆè¯´æ˜

## ğŸ“‹ æ•´åˆæ¦‚è¿°

å·²æˆåŠŸå°† Memory API æ•´åˆåˆ°ä¸» Flask åº”ç”¨ `master_ai_uploader_api.py`ï¼Œæ‰€æœ‰ API ç«¯ç‚¹ç°åœ¨ç»Ÿä¸€è¿è¡Œåœ¨ **ç«¯å£ 8008**ã€‚

## âœ… å®Œæˆçš„å·¥ä½œ

### 1. ä»£ç æ•´åˆ
- âœ… å°† Memory API çš„ä¸¤ä¸ªè·¯ç”±æ·»åŠ åˆ° `master_ai_uploader_api.py`
- âœ… æ·»åŠ å¿…è¦çš„å¯¼å…¥ (`json`, `get_supabase`)
- âœ… ä¿æŒæ‰€æœ‰åŸæœ‰åŠŸèƒ½å®Œæ•´æ— æŸ

### 2. è·¯ç”±æ•´åˆ
æ–°å¢ç«¯ç‚¹ï¼š
- `GET /api/master-ai/memory` - æŸ¥è¯¢å­AIè®°å¿†ï¼ˆæ”¯æŒ user_id, tag, limit å‚æ•°ï¼‰
- `GET /api/master-ai/memory/search` - æœç´¢è®°å¿†å†…å®¹ï¼ˆå‚æ•°: q, limitï¼‰

### 3. æ—¥å¿—ç³»ç»Ÿç»Ÿä¸€
- âœ… ä½¿ç”¨ç»Ÿä¸€çš„å›¾æ ‡é£æ ¼ï¼ˆğŸ§  ğŸ” âœ… âš ï¸ï¼‰
- âœ… è¯·æ±‚æ—¥å¿—æ ¼å¼ï¼š`ğŸ§  Memory API è¯·æ±‚ â†’ user_id=..., tag=..., limit=...`
- âœ… å“åº”æ—¥å¿—æ ¼å¼ï¼š`âœ… è¿”å› X æ¡è®°å¿†è®°å½•`

### 4. æ¸…ç†å·¥ä½œ
- âœ… åˆ é™¤ç‹¬ç«‹çš„ `master_ai_memory_api.py` æ–‡ä»¶
- âœ… åˆ é™¤ Memory API workflow
- âœ… æ›´æ–°é¦–é¡µç«¯ç‚¹åˆ—è¡¨

## ğŸ§ª éªŒè¯æµ‹è¯•

### æµ‹è¯•ç»“æœ
```
âœ… 7/7 API ç«¯ç‚¹æµ‹è¯•é€šè¿‡
âœ… 3/3 æµè§ˆå™¨è®¿é—®éªŒè¯é€šè¿‡
```

### æµ‹è¯•ç”¨ä¾‹
1. âœ… è·å–æ‰€æœ‰è®°å¿† - è¿”å› 5 æ¡
2. âœ… æŒ‰ user_id è¿‡æ»¤ - è¿”å› 5 æ¡
3. âœ… æŒ‰ tag è¿‡æ»¤ - è¿”å› 5 æ¡
4. âœ… æœç´¢ - ä¸­æ–‡å…³é”®è¯
5. âœ… æœç´¢ - è‹±æ–‡å…³é”®è¯
6. âœ… ä¸Šä¼ å†å² - è¿”å› 3 æ¡
7. âœ… ä¸Šä¼ ç»Ÿè®¡ - æ˜¾ç¤ºæ€»æ•°

## ğŸ“ ç»Ÿä¸€ API ç«¯ç‚¹æ¸…å•

**åŸºç¡€ URL**: `http://localhost:8008`

| æ–¹æ³• | ç«¯ç‚¹ | è¯´æ˜ |
|------|------|------|
| POST | `/api/master-ai/upload` | ä¸Šä¼ æ–‡ä»¶åˆ° Vault |
| GET | `/api/master-ai/context` | æŸ¥çœ‹ Vault å†…å®¹ |
| GET | `/api/master-ai/upload-history` | æŸ¥çœ‹ä¸Šä¼ å†å² |
| GET | `/api/master-ai/upload-stats` | æŸ¥çœ‹ä¸Šä¼ ç»Ÿè®¡ |
| GET | `/api/master-ai/memory` | æŸ¥è¯¢å­AIè®°å¿† |
| GET | `/api/master-ai/memory/search` | æœç´¢è®°å¿†å†…å®¹ |
| GET | `/upload` | Web ä¸Šä¼ ç•Œé¢ |
| GET | `/` | API é¦–é¡µ |

## ğŸ” Memory API å‚æ•°è¯´æ˜

### `/api/master-ai/memory`
**æŸ¥è¯¢å‚æ•°**:
- `user_id` (å¯é€‰): æŒ‰ç”¨æˆ·IDè¿‡æ»¤
- `tag` (å¯é€‰): æŒ‰æ ‡ç­¾è¿‡æ»¤ï¼ˆå¦‚ `vault`, `project_docs`ï¼‰
- `limit` (å¯é€‰): è¿”å›æ¡æ•°ï¼Œé»˜è®¤ 20

**ç¤ºä¾‹**:
```bash
# è·å–æ‰€æœ‰è®°å¿†
curl "http://localhost:8008/api/master-ai/memory?limit=10"

# æŒ‰æ ‡ç­¾è¿‡æ»¤
curl "http://localhost:8008/api/master-ai/memory?tag=vault&limit=5"

# æŒ‰ç”¨æˆ·è¿‡æ»¤
curl "http://localhost:8008/api/master-ai/memory?user_id=web_upload"
```

### `/api/master-ai/memory/search`
**æŸ¥è¯¢å‚æ•°**:
- `q` (å¿…éœ€): æœç´¢å…³é”®è¯
- `limit` (å¯é€‰): è¿”å›æ¡æ•°ï¼Œé»˜è®¤ 20

**ç¤ºä¾‹**:
```bash
# æœç´¢åŒ…å«"æ–‡æ¡£"çš„è®°å¿†
curl "http://localhost:8008/api/master-ai/memory/search?q=æ–‡æ¡£&limit=5"

# æœç´¢è‹±æ–‡å…³é”®è¯
curl "http://localhost:8008/api/master-ai/memory/search?q=design"
```

## ğŸ“Š æ—¥å¿—è¾“å‡ºç¤ºä¾‹

```
ğŸ§  Memory API è¯·æ±‚ â†’ user_id=web_upload, tag=vault, limit=5
âœ… è¿”å› 5 æ¡è®°å¿†è®°å½•

ğŸ” Memory æœç´¢ â†’ å…³é”®è¯='æ–‡æ¡£', limit=3
âœ… æœç´¢è¿”å› 3 æ¡ç»“æœ
```

## ğŸ¯ ä¼˜åŠ¿

1. **ç»Ÿä¸€ç«¯å£** - æ‰€æœ‰ API åœ¨ 8008 ç«¯å£ï¼Œä¾¿äºç®¡ç†
2. **ä»£ç å¤ç”¨** - å…±äº« Flask app å’Œ Supabase è¿æ¥
3. **æ—¥å¿—ä¸€è‡´** - ç»Ÿä¸€çš„æ—¥å¿—æ ¼å¼å’Œå›¾æ ‡é£æ ¼
4. **ç®€åŒ–éƒ¨ç½²** - åªéœ€ç®¡ç†ä¸€ä¸ª workflow
5. **æ€§èƒ½ä¼˜åŒ–** - å‡å°‘ç«¯å£å ç”¨å’Œè¿›ç¨‹æ•°

## ğŸ“ æŠ€æœ¯ç»†èŠ‚

### æ ‡ç­¾è¿‡æ»¤å®ç°
ä½¿ç”¨ PostgREST `cs` æ“ä½œç¬¦é…åˆ JSON ç¼–ç ï¼š
```python
query.filter("tags", "cs", json.dumps([tag]))
```

### é”™è¯¯å¤„ç†
- æœåŠ¡å™¨æ—¥å¿—ï¼šå®Œæ•´çš„ traceback
- å®¢æˆ·ç«¯å“åº”ï¼šä»…è¿”å›ç®€è¦é”™è¯¯ä¿¡æ¯
- å®‰å…¨æ€§ï¼šé¿å…æ³„éœ²å†…éƒ¨å®ç°ç»†èŠ‚

### æ•°æ®æ¥æº
- æ•°æ®æ¥è‡ª Supabase `child_ai_memory` è¡¨
- è‡ªåŠ¨ä» Upload API åŒæ­¥
- æ”¯æŒå®æ—¶æŸ¥è¯¢å’Œæœç´¢

## ğŸ”— ç›¸å…³æ–‡æ¡£

- è¯¦ç»†ä½¿ç”¨æŒ‡å—ï¼š`MEMORY_API_GUIDE.md`
- é¡¹ç›®æ¶æ„è¯´æ˜ï¼š`replit.md`
- Upload API æŒ‡å—ï¼š`VAULT_UPLOADER_GUIDE.md`
