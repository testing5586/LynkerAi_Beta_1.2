âœ… Replit æ‰§è¡Œä»»åŠ¡è¯´æ˜ï¼š**ä¿®å¤çœŸå‘½ç›˜éªŒè¯ä¸­å¿ƒçš„æ‰‹åŠ¨å§“å/æ€§åˆ«è¢«è¦†ç›–é—®é¢˜**

---

### ğŸ§© ä¿®æ”¹ç›®æ ‡

é˜²æ­¢åœ¨ç‚¹å‡»â€œğŸ” è¯†åˆ«å¹¶é¢„è§ˆâ€æ—¶ç³»ç»Ÿé‡æ–°è§£æè¦†ç›–æ‰æ‰‹åŠ¨å¡«å†™çš„å§“åä¸æ€§åˆ«ã€‚

---

### âœ… æ­¥éª¤ 1ï¼šåœ¨ HTML åŠ å…¥æ‰‹åŠ¨ä¿¡æ¯é”å®šåŒº

åœ¨è¯†åˆ«åŒºï¼ˆJSON è¾“å‡ºä¸Šæ–¹ï¼‰æ’å…¥ï¼š

```html
<div class="manual-input-section">
  <label>å‘½ä¸»å§“åï¼š</label>
  <input id="input_name" type="text" placeholder="è¯·è¾“å…¥å§“åæˆ–ä»£å·" />

  <label>æ€§åˆ«ï¼š</label>
  <select id="input_gender">
    <option value="">è¯·é€‰æ‹©</option>
    <option value="ç”·">ç”·</option>
    <option value="å¥³">å¥³</option>
  </select>

  <label style="margin-left:12px;">
    <input id="lock_manual" type="checkbox" checked />
    é”å®šæ‰‹åŠ¨ä¿¡æ¯ï¼ˆä¸è¢«è¯†åˆ«è¦†ç›–ï¼‰
  </label>

  <button id="apply_to_json" class="apply-btn">âœï¸ å†™å…¥ JSON</button>
</div>
```

---

### âœ… æ­¥éª¤ 2ï¼šåœ¨ JS ä¸­åŠ å…¥é€»è¾‘ï¼ˆå†™åœ¨è¯†åˆ«è„šæœ¬åº•éƒ¨ï¼‰

```javascript
function normalizeGender(g) {
  if (!g) return "";
  return String(g).replace(/\s/g, "")
    .replace(/female|å¥³/i, "å¥³").replace(/male|ç”·/i, "ç”·");
}

function mergeManualFields(parsed) {
  const lock = document.getElementById("lock_manual").checked;
  const manualName   = (document.getElementById("input_name").value || "").trim();
  const manualGender = normalizeGender(document.getElementById("input_gender").value || "");

  if (lock) {
    if (manualName)   parsed.name   = manualName;
    if (manualGender) parsed.gender = manualGender;
  } else {
    parsed.name   = manualName   || parsed.name   || "";
    parsed.gender = manualGender || parsed.gender || "";
  }
  return parsed;
}

function renderRecognized(parsed) {
  let merged = { ...parsed };
  merged = mergeManualFields(merged);
  document.getElementById("recognized_json").value = JSON.stringify({
    parsed: merged,
    score: parsed.score || {}
  }, null, 2);
}

document.getElementById("apply_to_json").onclick = function () {
  try {
    const box = document.getElementById("recognized_json");
    let data = {};
    try { data = JSON.parse(box.value || "{}"); } catch (_) { data = {}; }
    const parsed = mergeManualFields(data.parsed || {});
    box.value = JSON.stringify({ ...data, parsed }, null, 2);
  } catch (e) {
    alert("âŒ JSON å†™å…¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥æ ¼å¼");
  }
};
```

---

### âœ… æ­¥éª¤ 3ï¼šåç«¯ï¼ˆå¯é€‰ï¼‰

åœ¨ `verify_controller.py` æˆ–éªŒè¯é€»è¾‘ä¸­å¢åŠ ï¼š

```python
if not chart_data.get("name") or not chart_data.get("gender"):
    return {"status": "rejected", "reason": "å§“åæˆ–æ€§åˆ«ç¼ºå¤±ï¼Œè¯·å¡«å†™åé‡æ–°æäº¤ã€‚"}
```

---

### ğŸš€ æ‰§è¡Œåæ•ˆæœ

* æ‰‹åŠ¨è¾“å…¥ `å§“å/æ€§åˆ«` â†’ å†™å…¥ JSON âœ…
* å†ç‚¹å‡»â€œè¯†åˆ«å¹¶é¢„è§ˆâ€ä¸ä¼šè¢«è¦†ç›– âœ…
* å¯å‹¾é€‰/å–æ¶ˆâ€œé”å®šæ‰‹åŠ¨ä¿¡æ¯â€çµæ´»åˆ‡æ¢ âœ…
* ç¡®è®¤æäº¤éªŒè¯æ—¶ï¼Œè‹¥ç¼ºå°‘å§“åæˆ–æ€§åˆ«ä¼šæç¤ºæ‹’ç» âœ…

---

ğŸŸ© ç°åœ¨è®© Replit æ‰§è¡Œä»¥ä¸Šè„šæœ¬ï¼Œå³å¯ä¿®å¤çœŸå‘½ç›˜éªŒè¯ä¸­å¿ƒé€»è¾‘ã€‚
