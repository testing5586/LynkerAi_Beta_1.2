<!DOCTYPE html>
<html lang="en">
{% extends "base_dark.html" %}

{% block title %}ç´«å¾®æ–—æ•° Â· å‘½ç›˜ç»“æ„åŒ¹é…{% endblock %}

{% block ranking_title %}ç´«å¾®ç»“æ„æ’è¡Œæ¦œ ğŸ†{% endblock %}

{% block ranking_tabs %}
  <button class="lk-pill lk-pill-active">å‘½ç›˜ç»“æ„æ¦œ</button>
{% endblock %}

{% block ranking_desc %}
æ ¹æ®å‘½å®«ã€èº«å®«ã€ç¦å¾·å®«ç­‰å…³é”®å®«ä½ä¸ä¸»æ˜Ÿç»„åˆç»“æ„è¿›è¡ŒåŒ¹é…ï¼Œä»…ä¾›ç ”ç©¶ä¸å‚è€ƒã€‚
{% endblock %}

{% block ranking_list %}
  {% for item in leaderboard %}
  <div class="lk-ranking-item">
    <div class="lk-ranking-medal">No.{{ loop.index }}</div>
    <div class="lk-ranking-info">
      <div class="lk-ranking-name">çµå‹ #{{ item.friend_id }}</div>
      <div class="lk-ranking-meta">
        åŒ¹é… {{ item.match_count }} æ¬¡ Â· éªŒè¯ {{ item.verify_count }} æ¬¡
      </div>
    </div>
    <div class="lk-ranking-score">
      {{ item.final_score|default(0) }}<span class="lk-score-unit">%</span>
    </div>
  </div>
  {% endfor %}
{% endblock %}

{% block main_title %}ç´«å¾®æ–—æ•° Â· å‘½ç›˜ç»“æ„åŒ¹é…{% endblock %}

{% block main_subtitle %}
åŸºäºå‘½å®«ã€èº«å®«ä¸åäºŒå®«ä¸»æ˜Ÿç»„åˆçš„ç»“æ„ç›¸ä¼¼åº¦åŒ¹é…ï¼Œç”¨äºå¯»æ‰¾"ç›˜å‹ç›¸è¿‘"çš„çµå‹ã€‚
{% endblock %}

{% block content %}
    
  <!-- è¿™é‡Œä½ å¯ä»¥åŠ ä¸€ä¸ªå®«ä½ç®€ç•¥å›¾ / ç»Ÿè®¡è¯´æ˜ï¼›å…ˆä¿æŒå’Œå‰ä¸¤ä¸ªä¸€è‡´ç»“æ„ -->
  <section class="lk-banner">
    <div class="lk-banner-icon">ğŸ’¡</div>
    <div class="lk-banner-body">
      <div class="lk-banner-title">ç»“æ„åŒ¹é…è¯´æ˜</div>
      <div class="lk-banner-text">
        æ­¤å¤„åªæ¯”è¾ƒç´«å¾®æ–—æ•°ç›˜çš„"ç»“æ„"ï¼Œä¸è€ƒè™‘æµå¹´å¤§é™ä¸å½“å‰è¿åŠ¿ã€‚é€‚åˆå¯»æ‰¾ç›˜å‹ç›¸è¿‘çš„çµå‹ï¼Œç”¨äºç»éªŒåˆ†äº«ä¸å…±åŒéªŒè¯ã€‚
      </div>
    </div>
  </section>

  <!-- ä½ åé¢æ ¹æ®ç´«å¾®ç»“æ„è®¾è®¡ç­›é€‰ Pillï¼Œæ¯”å¦‚ï¼šåŒå‘½å®«ç³»ã€åŒèº«å®«ã€åŒä¸»æ˜Ÿç»„åˆç­‰ -->
  <section class="lk-filter-bar">
    <div class="lk-filter-label">ç­›é€‰æ¡ä»¶ï¼ˆå¯è‡ªå®šä¹‰ï¼‰</div>
    <div class="lk-filter-pills">
      <!-- é¢„ç•™ -->
      <button class="lk-pill lk-pill-active">é»˜è®¤ç»“æ„åŒ¹é…</button>
    </div>
  </section>

  <section class="lk-results">
    {% for match in matches %}
    <article class="lk-match-card">
      <div class="lk-match-header">
        <div class="lk-match-title">
          çµå‹ #{{ match.friend_id }}
        </div>
        <div class="lk-match-score-badge">
          {{ match.score }}% ç»“æ„ç›¸ä¼¼
        </div>
      </div>

      <div class="lk-match-meta">
        <span class="lk-match-meta-label">å‘½ç›˜æ‘˜è¦ï¼š</span>
        <span class="lk-match-meta-value">
          {{ match.summary|default("å‘½å®«å¤©åºœ Â· èº«å®«åŒè½ Â· ç¦å¾·æ­¦è´ª") }}
        </span>
      </div>

      <div class="lk-match-tags">
        {% for tag in match.tags %}
          <span class="lk-tag">{{ tag }}</span>
        {% endfor %}
      </div>

      <div class="lk-match-footer">
        <button class="lk-btn lk-btn-primary"
                onclick="window.location.href='{{ url_for('ziwei.ziwei_detail', friend_id=match.friend_id) }}'">
          æŸ¥çœ‹å‘½ç›˜
        </button>
        <button class="lk-btn lk-btn-ghost">
          æ‰“æ‹›å‘¼
        </button>
      </div>
    </article>
    {% else %}
      <div class="lk-empty">æš‚æ— åŒ¹é…ç»“æœã€‚</div>
    {% endfor %}
  </section>

{% endblock %}

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ziwei Match - Lynker AI</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/unified.css') }}">
</head>
<body>
    <div class="container">
        <!-- Left Profile Card -->
        <div class="profile-card">
            <div class="avatar">
                {{ birth_data.name[0] if birth_data.name else 'U' }}
            </div>
            <h2 class="user-name">{{ birth_data.name or 'Unknown' }}</h2>
            <p class="user-uid">UID: 8829301</p>
            
            <div class="profile-info-item">
                <span class="label">Gender</span>
                <span class="value">{{ 'Male' if birth_data.gender == 'male' else 'Female' }}</span>
            </div>
            <div class="profile-info-item">
                <span class="label">Location</span>
                <span class="value">{{ birth_data.location.name }}</span>
            </div>
            <div class="profile-info-item">
                <span class="label">Solar Date</span>
                <span class="value">{{ birth_data.true_solar_datetime[:10] }}</span>
            </div>
            <div class="profile-info-item">
                <span class="label">Solar Time</span>
                <span class="value">{{ birth_data.true_solar_datetime[11:16] }}</span>
            </div>
            <div class="profile-info-item">
                <span class="label">Shichen</span>
                <span class="value">{{ birth_data.shichen }} Hour</span>
            </div>

            <a href="/dashboard" class="back-btn">â† Back to Dashboard</a>
        </div>

        <!-- Right Content Area -->
        <div class="content-area">
            <div class="page-header">
                <h1 class="page-title">Ziwei Match</h1>
                <p class="page-subtitle">Imperial Astrology Connection Â· ç´«å¾®æ–—æ•°åŒ¹é…</p>
            </div>

            <!-- Ziwei Grid Display -->
            <div class="match-card" style="margin-bottom: 20px; padding: 15px;">
                <div class="match-header">
                    <div class="match-info">
                        <h3>Ziwei Chart</h3>
                        <p>Imperial Astrology</p>
                    </div>
                </div>
                <!-- Simplified Grid for Layout Demo -->
                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 5px; aspect-ratio: 1;">
                    <!-- Row 1 -->
                    <div style="background: rgba(255,255,255,0.05); border-radius: 4px; padding: 5px; font-size: 10px; text-align: center; display:flex; align-items:center; justify-content:center;">Si</div>
                    <div style="background: rgba(255,255,255,0.05); border-radius: 4px; padding: 5px; font-size: 10px; text-align: center; display:flex; align-items:center; justify-content:center;">Wu</div>
                    <div style="background: rgba(255,255,255,0.05); border-radius: 4px; padding: 5px; font-size: 10px; text-align: center; display:flex; align-items:center; justify-content:center;">Wei</div>
                    <div style="background: rgba(255,255,255,0.05); border-radius: 4px; padding: 5px; font-size: 10px; text-align: center; display:flex; align-items:center; justify-content:center;">Shen</div>
                    
                    <!-- Row 2 -->
                    <div style="background: rgba(255,255,255,0.05); border-radius: 4px; padding: 5px; font-size: 10px; text-align: center; display:flex; align-items:center; justify-content:center;">Chen</div>
                    <div style="grid-column: span 2; grid-row: span 2; display: flex; align-items: center; justify-content: center; background: rgba(224,195,168,0.1); border-radius: 4px;">
                        <div style="text-align: center;">
                            <div style="color: var(--accent-gold); font-size: 14px;">{{ birth_data.name }}</div>
                            <div style="font-size: 10px; opacity: 0.7;">Ziwei Chart</div>
                        </div>
                    </div>
                    <div style="background: rgba(255,255,255,0.05); border-radius: 4px; padding: 5px; font-size: 10px; text-align: center; display:flex; align-items:center; justify-content:center;">You</div>
                    
                    <!-- Row 3 -->
                    <div style="background: rgba(255,255,255,0.05); border-radius: 4px; padding: 5px; font-size: 10px; text-align: center; display:flex; align-items:center; justify-content:center;">Mao</div>
                    <!-- Center occupied -->
                    <div style="background: rgba(255,255,255,0.05); border-radius: 4px; padding: 5px; font-size: 10px; text-align: center; display:flex; align-items:center; justify-content:center;">Xu</div>
                    
                    <!-- Row 4 -->
                    <div style="background: rgba(255,255,255,0.05); border-radius: 4px; padding: 5px; font-size: 10px; text-align: center; display:flex; align-items:center; justify-content:center;">Yin</div>
                    <div style="background: rgba(255,255,255,0.05); border-radius: 4px; padding: 5px; font-size: 10px; text-align: center; display:flex; align-items:center; justify-content:center;">Chou</div>
                    <div style="background: rgba(255,255,255,0.05); border-radius: 4px; padding: 5px; font-size: 10px; text-align: center; display:flex; align-items:center; justify-content:center;">Zi</div>
                    <div style="background: rgba(255,255,255,0.05); border-radius: 4px; padding: 5px; font-size: 10px; text-align: center; display:flex; align-items:center; justify-content:center;">Hai</div>
                </div>
            </div>

            <!-- Score Hint -->
            <div class="score-hint-box">
                <div class="hint-icon">ğŸ’¡</div>
                <div class="hint-text">
                    Your Life Palace is in <strong>Zi</strong> with <strong>Zi Wei</strong> star. You are a natural leader.
                    Compatible with people who have <strong>Tian Fu</strong> in their Life Palace.
                </div>
            </div>

            <!-- Filters -->
            <div class="filter-section">
                <button class="filter-btn active">All Matches</button>
                <button class="filter-btn">Life Palace Match</button>
                <button class="filter-btn">Star Resonance</button>
                <button class="filter-btn">Body Palace</button>
                <button class="filter-btn">San Fang Si Zheng</button>
            </div>

            <!-- Match List -->
            <div class="match-list">
                <!-- Mock Match 1 -->
                <div class="match-card">
                    <div class="match-header">
                        <div class="match-user">
                            <div class="match-avatar" style="background: #e67e22;">J</div>
                            <div class="match-info">
                                <h3>James Tan</h3>
                                <p>Kuala Lumpur Â· 1988</p>
                            </div>
                        </div>
                        <div class="match-score">
                            <div class="score-val">96</div>
                            <div class="score-label">Score</div>
                        </div>
                    </div>
                    <div class="match-tags">
                        <span class="tag highlight">Life Palace Match</span>
                        <span class="tag highlight">Star Resonance</span>
                        <span class="tag">Tian Fu</span>
                    </div>
                    <div class="card-actions">
                        <button class="action-btn btn-view">View Profile</button>
                        <button class="action-btn btn-hi">Say Hi</button>
                    </div>
                </div>

                <!-- Mock Match 2 -->
                <div class="match-card">
                    <div class="match-header">
                        <div class="match-user">
                            <div class="match-avatar" style="background: #9b59b6;">A</div>
                            <div class="match-info">
                                <h3>Alice Wong</h3>
                                <p>Penang Â· 1994</p>
                            </div>
                        </div>
                        <div class="match-score">
                            <div class="score-val">90</div>
                            <div class="score-label">Score</div>
                        </div>
                    </div>
                    <div class="match-tags">
                        <span class="tag highlight">Body Palace</span>
                        <span class="tag">Tai Yang</span>
                    </div>
                    <div class="card-actions">
                        <button class="action-btn btn-view">View Profile</button>
                        <button class="action-btn btn-hi">Say Hi</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}